document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".burger"),t=document.querySelector(".top-nav");e.addEventListener("click",(function(){this.classList.toggle("active"),t.classList.toggle("activemobile")}));const r=document.querySelector(".mobile-filter"),n=document.querySelector(".filter"),c=document.querySelector(".cancel-filter");document.querySelector(".active-filter");r.addEventListener("click",(function(e){e.preventDefault(),n.classList.add("active-filter")})),c.addEventListener("click",(function(){n.classList.remove("active-filter")}));const a=document.querySelectorAll(".select");a.forEach((e=>{const t=e.querySelector(".select__in"),r=e.querySelectorAll(".select__item"),n=e.querySelector(".select__input"),c=new Event("change");t.addEventListener("click",(()=>{a.forEach((t=>{t!==e&&t.classList.remove("is-opened")})),e.classList.toggle("is-opened")})),r.forEach((a=>{a.addEventListener("click",(()=>{n.value=a.dataset.value,n.dispatchEvent(c),t.innerHTML=a.innerHTML,r.forEach((e=>{e.classList.remove("is-active")})),a.classList.add("is-active"),e.classList.remove("is-opened")}))}))})),document.addEventListener("click",(e=>{e.target.closest(".select")||a.forEach((e=>{e.classList.contains("is-opened")&&e.classList.remove("is-opened")}))})),document.addEventListener("keyup",(e=>{"Escape"==e.key&&a.forEach((e=>{e.classList.contains("is-opened")&&e.classList.remove("is-opened")}))})),orders.orderSum=0;const s=document.querySelector(".card-bott"),o=(document.querySelector(".filter-season"),12);function d(e){const t=(e-1)*o,r=t+o,n=jsonData.slice(t,r);var c;c=n,s.innerHTML="",c.forEach((e=>{console.log(e);const t=document.createElement("figure"),r=document.createElement("figcaption");if(""!==e.saleprice){const t=document.createElement("span"),n=100-100*parseFloat(e.price)/parseFloat(e.saleprice);t.classList.add("card-flag"),t.innerText=`sale -${n.toFixed(0)}%`,r.appendChild(t)}t.classList.add("card-box"),t.appendChild(r);const n=document.createElement("a");n.classList.add("click-card"),n.href="#",r.appendChild(n);const c=document.createElement("img");c.src=e.img,c.alt=e.alt,r.appendChild(c);const a=document.createElement("h2");a.classList.add("header-card"),a.innerText=e.head,r.appendChild(a);const o=document.createElement("p");o.classList.add("old-price"),o.innerText=e.saleprice,r.appendChild(o);const d=document.createElement("p");d.classList.add("new-price"),d.innerText=e.price,r.appendChild(d);const i=document.createElement("div");i.classList.add("input-block"),r.appendChild(i);const l=["40","41","42","43","44","45"];for(const t of l){const r=document.createElement("input");r.type="checkbox",r.id=`input-${e.id}-${t}`,r.value=t;const n=document.createElement("label");n.classList.add(`label${t}`),n.setAttribute("for",`input-${e.id}-${t}`),n.innerText=`${t}`,i.appendChild(r),i.appendChild(n)}const u=document.createElement("a");u.classList.add("cta-card"),u.setAttribute("data-value",e.id),u.innerText=e.cta,u.href=e.href,r.appendChild(u),s.appendChild(t)}))}function i(e,t,r){var n=document.createElement("button");return n.innerText=e,n.className=t,n.onclick=r,n}function l(){for(var e=document.getElementById("pagination").getElementsByTagName("button"),t=0;t<e.length;t++){parseInt(e[t].innerText)===currentPage?(e[t].classList.add("current-page"),e[t].disabled=!0):(e[t].classList.remove("current-page"),e[t].disabled=!1)}}currentPage=1,totalPages=1,jsonData=[],fetch("products.json").then((e=>e.json())).then((e=>{jsonData=e,totalPages=Math.ceil(jsonData.length/o),d(currentPage),function(){var e=document.querySelector("#pagination");e.innerHTML="",e.appendChild(i("←","arrow-pag prev",(function(){currentPage>1&&(currentPage--,d(currentPage),l())})));var t=4,r=Math.floor(t/2),n=Math.max(1,currentPage-r),c=Math.min(totalPages,n+t-1);n>1&&(e.appendChild(i(1,"",(function(){currentPage=1,d(currentPage),l()}))),n>2&&e.appendChild(i("...","ellipsis",(function(){}))));for(var a=n;a<=c;a++)e.appendChild(i(a,a===currentPage?"active":"",(function(){currentPage=parseInt(this.innerText),d(currentPage),l()})));c<totalPages&&(c<totalPages-1&&e.appendChild(i("...","ellipsis",(function(){}))),e.appendChild(i(totalPages,"",(function(){currentPage=totalPages,d(currentPage),l()})))),e.appendChild(i("→","arrow-pag next",(function(){currentPage<totalPages&&(currentPage++,d(currentPage),l())}))),l()}()})).catch((e=>console.error("Помилка завантаження даних:",e)));const u=document.querySelectorAll(".slider-images img"),p=document.querySelector(".arr-left"),m=document.querySelector(".arr-right"),v=document.querySelectorAll(".slide-description");let f=0;function y(){v[f].classList.remove("active"),u[f].classList.remove("active"),f=(f+1)%u.length,u[f].classList.add("active"),v[f].classList.add("active")}y();let g=setInterval(y,3e3);p.addEventListener("click",(function(){clearInterval(g),v[f].classList.remove("active"),u[f].classList.remove("active"),f=(f-1+u.length)%u.length,u[f].classList.add("active"),v[f].classList.add("active"),g=setInterval(y,3e3)})),m.addEventListener("click",(function(){clearInterval(g),y(),g=setInterval(y,3e3)}));const h=document.querySelector(".cart"),q=document.querySelector(".popup"),L=document.querySelector(".basket-back"),b=document.querySelector("body");function S(){q.classList.toggle("d-block"),b.classList.toggle("hidden")}h.addEventListener("click",S),L.addEventListener("click",S);const P=document.querySelectorAll(".range-input input"),E=document.querySelectorAll(".price-input input"),x=document.querySelector(".slider .progress");let T=1e3;E.forEach((e=>{e.addEventListener("input",(e=>{let t=parseInt(E[0].value),r=parseInt(E[1].value);r-t>=T&&r<=P[1].max&&("input-min"===e.target.className?(P[0].value=t,x.style.left=t/P[0].max*100+"%"):(P[1].value=r,x.style.right=100-r/P[1].max*100+"%"))}))})),P.forEach((e=>{e.addEventListener("input",(e=>{let t=parseInt(P[0].value),r=parseInt(P[1].value);r-t<T?"range-min"===e.target.className?P[0].value=r-T:P[1].value=t+T:(E[0].value=t,E[1].value=r,x.style.left=t/P[0].max*100+"%",x.style.right=100-r/P[1].max*100+"%")}))}));let k=document.querySelector(".img-carousel"),D=document.querySelectorAll(".step-block");const C=document.querySelectorAll(".img-carousel img");console.log(k),function(){let e=0;D.forEach((function(t){e+=t.getBoundingClientRect().height,console.log(e)})),window,innerHeight>=960&&(k.style.height=e+40+"px")}();let O=0;setInterval((function(){C[O].classList.remove("active"),O=(O+1)%C.length,C[O].classList.add("active")}),3e3)}));let orderDetailSum=document.querySelector(".order-total-price"),numberOfProductsDOM=document.querySelector(".calc-added-products"),caclnumberOfProducts=0,addedProductsList=document.querySelector(".added-products-list "),orderDiscount=document.querySelector(".order-discount"),orderDiscountCalc=0;orders={};const cartWaitTimeout=setTimeout((function(){cart()}),1e3);function cart(){if(document.querySelectorAll(".cta-card")){clearInterval(cartWaitTimeout);document.querySelectorAll(".cta-card");document.querySelectorAll(".cta-card").forEach((t=>{t.addEventListener("click",(function(r){r.preventDefault();const n=this.getAttribute("data-value"),c=[];document.querySelectorAll(`input[type="checkbox"][id^="input-${n}"]:checked`).forEach((e=>{c.push(e.value)})),console.log("Вибрані розміри для продукту з ID",n,":",c),function(t,r){let n=t.dataset.value;fetch("products.json").then((e=>e.json())).then((t=>{const c=t.find((e=>e.id===n));if(r.length>1){console.log(r);for(let t=0;t<r.length;t++)orders[n+r[t]]?document.querySelector(".plus-quantity[data-value='"+n+r[t]+"']").click():(orders[n+r[t]]={product:c,quantity:1},r&&(orders[n+r[t]].size=r[t]),orders.orderSum+=Number(orders[n+r[t]].product.saleprice.slice(0,-4)),e(n,orders[n+r[t]].size),console.log(document.querySelector(".minus-quantity[data-value='"+n+r[t]+"']")),plusBtn(".plus-quantity[data-value='"+n+r[t]+"']"),minBtn(".minus-quantity[data-value='"+n+r[t]+"']"),caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts),orderDiscountCalc+=orders[n+r[t]].product.saleprice?Number(orders[n+r[t]].product.saleprice.slice(0,-4))-Number(orders[n+r[t]].product.price.slice(0,-4)):0,orderDiscount.innerText=orderDiscountCalc,orderDetailSum.innerText=orders.orderSum;console.log(orders)}else orders[n+r]?(caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts,orders[n+r].size[0]!=r?(e(n,r),setTimeout((()=>{console.log(document.querySelector(".minus-quantity[data-value='"+n+r+"']")),plusBtn('.basket-card[data-value="'+n+r+'"] .plus-quantity'),minBtn(".minus-quantity[data-value='"+n+r+"']")}),100)):orders[n+r].quantity++,orders.orderSum+=Number(orders[n+r].product.saleprice.slice(0,-4)),setTimeout((function(){const e=addedProductsList.querySelector('.basket-card[data-value="'+n+r+'"] .total-price span'),t=addedProductsList.querySelector('.basket-card[data-value="'+n+r+'"] .quantity-number');orders[n+r].totalPrice=Number(orders[n+r].product.price.slice(0,-4))*orders[n+r].quantity,e.innerText=orders[n+r].totalPrice+" грн",t.innerText=orders[n+r].quantity}),10),orderDiscountCalc+=orders[n+r].product.saleprice?Number(orders[n+r].product.saleprice.slice(0,-4))-Number(orders[n+r].product.price.slice(0,-4)):0,orderDiscount.innerText=orderDiscountCalc):(orders[n+r]={product:c,quantity:0},orders[n+r].quantity+=1,r&&(orders[n+r].size=r),orders.orderSum+=Number(orders[n+r].product.saleprice.slice(0,-4)),e(n,orders[n+r].size),console.log(document.querySelector(".minus-quantity[data-value='"+n+r+"']")),plusBtn(".plus-quantity[data-value='"+n+r+"']"),minBtn(".minus-quantity[data-value='"+n+r+"']"),caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts,orderDiscountCalc+=orders[n+r].product.saleprice?Number(orders[n+r].product.saleprice.slice(0,-4))-Number(orders[n+r].product.price.slice(0,-4)):0,orderDiscount.innerText=orderDiscountCalc),orderDetailSum.innerText=orders.orderSum}))}(t,c)}))}))}function e(e,t){fetch("products.json").then((e=>e.json())).then((r=>{const n=r.find((t=>t.id===e)),c=document.createElement("div");c.innerHTML=`\n                    <div class="basket-card flex items-center" data-value=${n.id+""+t}>\n                        <div class="basket-product-description flex items-center">\n                            <img src=${n.img}>\n                            <div class="description">\n                                <h3>${n.head}</h3>\n                                <table>\n                                    <tr>\n                                        <td>колір</td>\n                                        <td>${n.color}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>розмір</td>\n                                        <td class="size-span">${t}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>ціна</td>\n                                        <td>${n.price} <span>${n.saleprice}</span></td>\n                                    </tr>\n                                    <tr>\n                                        <td>кількість</td>\n                                        <td>\n                                            <div class="quantity flex">\n                                                <div class="minus-quantity" data-value="${n.id+""+t}">-</div>\n                                                <div class="quantity-number">${orders[n.id+t].quantity}</div>\n                                                <div class="plus-quantity" data-value="${n.id+""+t}">+</div>\n                                            </div>\n                                        </td>\n                                    </tr>\n                                </table>\n                                <div class="delete-product">видалити товар</div>\n                            </div>\n                        </div>\n                        <div class="total-price">\n                            <span>${Number(orders[n.id+t].product.price.slice(0,-4))*orders[n.id+t].quantity+" грн"}</span> \n                        </div>\n                    </div>\n                `,addedProductsList.appendChild(c)}))}}const inputMask=document.querySelector(".inputMask");function plusBtn(e){fetch("products.json").then((e=>e.json())).then((t=>{document.querySelector(e).addEventListener("click",(function(){let e=this.dataset.value;console.log(e);let r=this.dataset.value.slice(0,-2);t.find((e=>e.id===r));const n=e;if(orders[n]){orders[n].quantity+=1;const t=addedProductsList.querySelector('[data-value="'+e+'"] .total-price span'),r=addedProductsList.querySelector('[data-value="'+e+'"] .quantity-number');t.innerText=orders[n].product.price.slice(0,-4)*orders[n].quantity+" грн",r.innerText=orders[n].quantity,orders.orderSum+=Number(orders[n].product.saleprice.slice(0,-4))}orderDetailSum.innerText=orders.orderSum,caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts,orderDiscountCalc+=orders[r+e.slice(-2)].product.saleprice?Number(orders[r+e.slice(-2)].product.saleprice.slice(0,-4))-Number(orders[r+e.slice(-2)].product.price.slice(0,-4)):0,orderDiscount.innerText=orderDiscountCalc}))}))}function minBtn(e){fetch("products.json").then((e=>e.json())).then((t=>{document.querySelector(e).addEventListener("click",(function(){let e=this.dataset.value,r=e.slice(0,-2);t.find((e=>e.id===r));const n=e;if(console.log(r),console.log(n),orders[n]&&1!==orders[n].quantity){orders[n].quantity-=1;const t=addedProductsList.querySelector('[data-value="'+n+'"] .total-price span'),c=addedProductsList.querySelector('[data-value="'+n+'"] .quantity-number');orders[n].totalPrice=Number(orders[n].product.price.slice(0,-4))*orders[n].quantity,t.innerText=orders[n].totalPrice+" грн",c.innerText=orders[n].quantity,orders.orderSum-=Number(orders[n].product.saleprice.slice(0,-4)),1!==c&&caclnumberOfProducts--,numberOfProductsDOM.innerText=caclnumberOfProducts,orderDetailSum.innerText=orders.orderSum,orderDiscountCalc-=orders[r+e.slice(-2)].product.saleprice?Number(orders[r+e.slice(-2)].product.saleprice.slice(0,-4))-Number(orders[r+e.slice(-2)].product.price.slice(0,-4)):0,orderDiscount.innerText=orderDiscountCalc}}))}))}function sendData(){let e=document.querySelector("#orderProductsObject");const t=JSON.stringify(orders);e.value=t}inputMask.value="+38",inputMask.addEventListener("input",(function(){let e=inputMask.value;e.length>13?inputMask.value=e.slice(0,13):e.startsWith("+38")||(inputMask.value="+38"+e.slice(3))})),document.addEventListener("DOMContentLoaded",(function(){let e=document.querySelectorAll(".cta-card");console.log(e),e.forEach((function(e){e.addEventListener("click",(function(){document.querySelectorAll(".plus-quantity");plusBtn()}))}))}));
