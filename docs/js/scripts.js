document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".burger"),t=document.querySelector(".top-nav");e.addEventListener("click",(function(){this.classList.toggle("active"),t.classList.toggle("activemobile")}));const n=document.querySelector(".mobile-filter"),r=document.querySelector(".filter"),c=document.querySelector(".cancel-filter");document.querySelector(".active-filter");n.addEventListener("click",(function(e){e.preventDefault(),r.classList.add("active-filter")})),c.addEventListener("click",(function(){r.classList.remove("active-filter")}));const a=document.querySelectorAll(".select");a.forEach((e=>{const t=e.querySelector(".select__in"),n=e.querySelectorAll(".select__item"),r=e.querySelector(".select__input"),c=new Event("change");t.addEventListener("click",(()=>{a.forEach((t=>{t!==e&&t.classList.remove("is-opened")})),e.classList.toggle("is-opened")})),n.forEach((a=>{a.addEventListener("click",(()=>{r.value=a.dataset.value,r.dispatchEvent(c),t.innerHTML=a.innerHTML,n.forEach((e=>{e.classList.remove("is-active")})),a.classList.add("is-active"),e.classList.remove("is-opened")}))}))})),document.addEventListener("click",(e=>{e.target.closest(".select")||a.forEach((e=>{e.classList.contains("is-opened")&&e.classList.remove("is-opened")}))})),document.addEventListener("keyup",(e=>{"Escape"==e.key&&a.forEach((e=>{e.classList.contains("is-opened")&&e.classList.remove("is-opened")}))})),orders.orderSum=0;const o=document.querySelector(".card-bott"),s=(document.querySelector(".filter-season"),12);let l=1,i=1,d=[];function u(e){const t=(e-1)*s,n=t+s,r=d.slice(t,n);var c;c=r,o.innerHTML="",c.forEach((e=>{console.log(e);const t=document.createElement("figure"),n=document.createElement("figcaption");if(""!==e.saleprice){const t=document.createElement("span"),r=100-100*parseFloat(e.price)/parseFloat(e.saleprice);t.classList.add("card-flag"),t.innerText=`sale -${r.toFixed(0)}%`,n.appendChild(t)}t.classList.add("card-box",e.category,e.color,e.model,e.material,e.style,e.size40,e.size41,e.size42,e.size43,e.size44,e.size45),t.appendChild(n);const r=document.createElement("a");r.classList.add("click-card"),r.href="#",n.appendChild(r);const c=document.createElement("img");c.src=e.img,c.alt=e.alt,n.appendChild(c);const a=document.createElement("h2");a.classList.add("header-card"),a.innerText=e.head,n.appendChild(a);const s=document.createElement("p");s.classList.add("old-price"),s.innerText=e.saleprice,n.appendChild(s);const l=document.createElement("p"),i=parseInt(e.price.replace(/\D/g,""));t.dataset.price=i,l.classList.add("new-price"),l.innerText=e.price,n.appendChild(l);const d=document.createElement("div");d.classList.add("input-block"),n.appendChild(d);const u=["40","41","42","43","44","45"];for(const t of u){const n=document.createElement("input");n.type="checkbox",n.id=`input-${e.id}-${t}`,n.value=t;const r=document.createElement("label");r.classList.add(`label${t}`),r.setAttribute("for",`input-${e.id}-${t}`),r.innerText=`${t}`,d.appendChild(n),d.appendChild(r)}const m=document.createElement("a");m.classList.add("cta-card"),m.setAttribute("data-value",e.id),m.innerText=e.cta,m.href=e.href,n.appendChild(m),o.appendChild(t)}))}function m(){var e=document.querySelector("#pagination");if(e.innerHTML="",i>1){e.appendChild(p("←","arrow-pag prev",(function(){l>1&&(l--,u(l),m(),v())})));const t=4,n=Math.floor(t/2),r=Math.max(1,l-n),c=Math.min(i,r+t-1);r>1&&(e.appendChild(p(1,"",(function(){l=1,u(l),m(),v()}))),r>2&&e.appendChild(p("...","ellipsis",(function(){}))));for(let t=r;t<=c;t++)!function(t){e.appendChild(p(t,t===l?"active":"",(function(){l=t,u(l),m(),v()})))}(t);c<i&&(c<i-1&&e.appendChild(p("...","ellipsis",(function(){}))),e.appendChild(p(i,"",(function(){l=i,u(l),m(),v()})))),e.appendChild(p("→","arrow-pag next",(function(){l<i&&(l++,u(l),m(),v())})))}}function p(e,t,n){const r=document.createElement("button");return r.innerText=e,r.className=t,r.onclick=n,r}function v(){const e=document.querySelector("#pagination").getElementsByTagName("button");for(var t=0;t<e.length;t++){parseInt(e[t].innerText)===l?(e[t].classList.add("current-page"),e[t].disabled=!0):(e[t].classList.remove("current-page"),e[t].disabled=!1)}}fetch("products.json").then((e=>e.json())).then((e=>{d=e,i=Math.ceil(d.length/s),u(l),m()})).catch((e=>console.error("Помилка завантаження даних:",e)));const f=document.querySelectorAll(".card-cta-season"),y=["winter","summer","demiseason"],h=localStorage.getItem("lastSelectedCategory");console.log(y);let q=h;f.forEach((e=>e.style.color="#191919")),h||(q="#all",localStorage.setItem("lastSelectedCategory",q));const g=document.querySelector(`[data-href="${q}"]`);function S(){const e=parseInt(document.querySelector(".input-min").value)||0,t=parseInt(document.querySelector(".input-max").value)||1e4,n=L("size"),r=L("color"),c=L("model"),a=L("season"),o=L("material"),s=L("style");y.forEach((l=>{document.querySelectorAll(`.${l}`).forEach((l=>{const i=E(l.classList,n)&&E(l.classList,r)&&E(l.classList,c)&&E(l.classList,a)&&E(l.classList,o)&&E(l.classList,s)&&function(e,t,n){const r=parseInt(e.dataset.price);return r>=t&&r<=n}(l,e,t);l.style.display=i?"grid":"none"}))}))}function L(e){return Array.from(document.querySelectorAll(`input[name="${e}"]:checked`)).map((e=>e.value))}function E(e,t){return 0===t.length||t.some((t=>e.contains(t)))}g&&(g.style.display="grid"),y.forEach((e=>{document.querySelectorAll(`.${e}`).forEach((t=>{t.style.display=q===`${e}`||"#all"===q?"grid":"none"}))})),f.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),f.forEach((e=>{e.style.color="#191919",e.style.backgroundColor="#fff"})),e.style.color="#fff",e.style.backgroundColor="#4E98B6";let n=t.target.getAttribute("data-href");var r;localStorage.setItem("lastSelectedCategory",n),r=n,y.forEach((e=>{document.querySelectorAll(`.${e}`).forEach((t=>{t.style.display=r===`${e}`||"#all"===r?"grid":"none"}))}))}))})),document.querySelector(".submit-filter").addEventListener("click",(function(e){e.preventDefault(),S()})),document.querySelector('button.cta-transparent.reset-filter[type="reset"]').addEventListener("click",(function(e){e.preventDefault(),document.querySelectorAll('input[type="checkbox"]').forEach((e=>{e.checked=!1})),document.querySelector(".input-min").value="0",document.querySelector(".input-max").value="10000",document.querySelector(".range-min").value="0",document.querySelector(".range-max").value="10000",document.querySelectorAll(".product-card").forEach((e=>{e.style.display="grid"})),S()}));const b=document.querySelectorAll(".slider-images img"),k=document.querySelector(".arr-left"),x=document.querySelector(".arr-right"),T=document.querySelectorAll(".slide-description");let P=0;function C(){T[P].classList.remove("active"),b[P].classList.remove("active"),P=(P+1)%b.length,b[P].classList.add("active"),T[P].classList.add("active")}C();let A=setInterval(C,3e3);k.addEventListener("click",(function(){clearInterval(A),T[P].classList.remove("active"),b[P].classList.remove("active"),P=(P-1+b.length)%b.length,b[P].classList.add("active"),T[P].classList.add("active"),A=setInterval(C,3e3)})),x.addEventListener("click",(function(){clearInterval(A),C(),A=setInterval(C,3e3)}));const O=document.querySelector(".cart"),$=document.querySelector(".basket-popup"),M=document.querySelector(".basket-back"),I=document.querySelector(".added-products-list"),D=document.querySelector("body");function z(){$.classList.toggle("d-block"),D.classList.toggle("hidden")}I.style.height=window.innerHeight-300+"px",O.addEventListener("click",z),M.addEventListener("click",z);const B=document.querySelectorAll(".range-input input"),N=document.querySelectorAll(".price-input input"),j=document.querySelector(".slider .progress");let w=1e3;N.forEach((e=>{e.addEventListener("input",(e=>{let t=parseInt(N[0].value),n=parseInt(N[1].value);n-t>=w&&n<=B[1].max&&("input-min"===e.target.className?(B[0].value=t,j.style.left=t/B[0].max*100+"%"):(B[1].value=n,j.style.right=100-n/B[1].max*100+"%"))}))})),B.forEach((e=>{e.addEventListener("input",(e=>{let t=parseInt(B[0].value),n=parseInt(B[1].value);n-t<w?"range-min"===e.target.className?B[0].value=n-w:B[1].value=t+w:(N[0].value=t,N[1].value=n,j.style.left=t/B[0].max*100+"%",j.style.right=100-n/B[1].max*100+"%")}))}));let H=document.querySelector(".img-carousel"),_=document.querySelectorAll(".step-block");const F=document.querySelectorAll(".img-carousel img");console.log(H),function(){let e=0;_.forEach((function(t){e+=t.getBoundingClientRect().height,console.log(e)})),window,innerHeight>=960&&(H.style.height=e+40+"px")}();let W=0;setInterval((function(){F[W].classList.remove("active"),W=(W+1)%F.length,F[W].classList.add("active")}),3e3)}));let orderDetailSum=document.querySelector(".order-total-price"),numberOfProductsDOM=document.querySelector(".calc-added-products"),caclnumberOfProducts=0,addedProductsList=document.querySelector(".added-products-list "),orders={};const cartWaitTimeout=setTimeout((function(){cart()}),1e3);function cart(){if(document.querySelectorAll(".cta-card")){clearInterval(cartWaitTimeout);document.querySelectorAll(".cta-card");document.querySelectorAll(".cta-card").forEach((t=>{t.addEventListener("click",(function(n){n.preventDefault();const r=this.getAttribute("data-value"),c=[];document.querySelectorAll(`input[type="checkbox"][id^="input-${r}"]:checked`).forEach((e=>{c.push(e.value)})),console.log("Вибрані розміри для продукту з ID",r,":",c),function(t,n){let r=t.dataset.value;fetch("products.json").then((e=>e.json())).then((t=>{const c=t.find((e=>e.id===r));if(n.length>1){alert("more than 1"),console.log(n);for(let t=0;t<n.length;t++)orders[r+n[t]]?document.querySelector(".plus-quantity[data-value='"+r+n[t]+"']").click():(orders[r+n[t]]={product:c,quantity:1},n&&(orders[r+n[t]].size=n[t]),orders.orderSum+=Number(orders[r+n[t]].product.price.slice(0,-4)),e(r,orders[r+n[t]].size),console.log(document.querySelector(".minus-quantity[data-value='"+r+n[t]+"']")),plusBtn(".plus-quantity[data-value='"+r+n[t]+"']"),minBtn(".minus-quantity[data-value='"+r+n[t]+"']"),caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts);console.log(orders)}else orders[r+n]?(caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts,orders[r+n].size[0]!=n?(e(r,n),setTimeout((()=>{console.log(document.querySelector(".minus-quantity[data-value='"+r+n+"']")),plusBtn('.basket-card[data-value="'+r+n+'"] .plus-quantity'),minBtn(".minus-quantity[data-value='"+r+n+"']")}),100)):orders[r+n].quantity++,orders.orderSum+=Number(orders[r+n].product.price.slice(0,-4)),setTimeout((function(){const e=addedProductsList.querySelector('.basket-card[data-value="'+r+n+'"] .total-price span'),t=addedProductsList.querySelector('.basket-card[data-value="'+r+n+'"] .quantity-number');orders[r+n].totalPrice=Number(orders[r+n].product.price.slice(0,-4))*orders[r+n].quantity,e.innerText=orders[r+n].totalPrice+" грн",t.innerText=orders[r+n].quantity}),10)):(orders[r+n]={product:c,quantity:0},orders[r+n].quantity+=1,n&&(orders[r+n].size=n),orders.orderSum+=Number(orders[r+n].product.price.slice(0,-4)),e(r,orders[r+n].size),console.log(document.querySelector(".minus-quantity[data-value='"+r+n+"']")),plusBtn(".plus-quantity[data-value='"+r+n+"']"),minBtn(".minus-quantity[data-value='"+r+n+"']"),caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts),orderDetailSum.innerText=orders.orderSum}))}(t,c)}))}))}function e(e,t){fetch("products.json").then((e=>e.json())).then((n=>{const r=n.find((t=>t.id===e)),c=document.createElement("div");c.innerHTML=`\n                    <div class="basket-card flex items-center" data-value=${r.id+""+t}>\n                        <div class="basket-product-description flex items-center">\n                            <img src=${r.img}>\n                            <div class="description">\n                                <h3>${r.head}</h3>\n                                <table>\n                                    <tr>\n                                        <td>колір</td>\n                                        <td></td>\n                                    </tr>\n                                    <tr>\n                                        <td>розмір</td>\n                                        <td class="size-span">${t}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>ціна</td>\n                                        <td>${r.price} <span>${r.saleprice}</span></td>\n                                    </tr>\n                                    <tr>\n                                        <td>кількість</td>\n                                        <td>\n                                            <div class="quantity flex">\n                                                <div class="minus-quantity" data-value="${r.id+""+t}">-</div>\n                                                <div class="quantity-number">${orders[r.id+t].quantity}</div>\n                                                <div class="plus-quantity" data-value="${r.id+""+t}">+</div>\n                                            </div>\n                                        </td>\n                                    </tr>\n                                </table>\n                                <div class="delete-product">видалити товар</div>\n                            </div>\n                        </div>\n                        <div class="total-price">\n                            <span>${Number(orders[r.id+t].product.price.slice(0,-4))*orders[r.id+t].quantity+" грн"}</span> \n                        </div>\n                    </div>\n                `,addedProductsList.appendChild(c)}))}}const inputMask=document.querySelector(".inputMask");function plusBtn(e){fetch("products.json").then((e=>e.json())).then((t=>{document.querySelector(e).addEventListener("click",(function(){let e=this.dataset.value;console.log(e);let n=this.dataset.value.slice(0,-2);t.find((e=>e.id===n));const r=e;if(orders[r]){orders[r].quantity+=1;const t=addedProductsList.querySelector('[data-value="'+e+'"] .total-price span'),n=addedProductsList.querySelector('[data-value="'+e+'"] .quantity-number');t.innerText=orders[r].product.price.slice(0,-4)*orders[r].quantity+" грн",n.innerText=orders[r].quantity,orders.orderSum+=Number(orders[r].product.price.slice(0,-4))}orderDetailSum.innerText=orders.orderSum,caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts}))}))}function minBtn(e){fetch("products.json").then((e=>e.json())).then((t=>{document.querySelector(e).addEventListener("click",(function(){let e=this.dataset.value,n=e.slice(0,-2);t.find((e=>e.id===n));const r=e;if(console.log(n),console.log(r),orders[r]&&1!==orders[r].quantity){orders[r].quantity-=1;const e=addedProductsList.querySelector('[data-value="'+r+'"] .total-price span'),t=addedProductsList.querySelector('[data-value="'+r+'"] .quantity-number');orders[r].totalPrice=Number(orders[r].product.price.slice(0,-4))*orders[r].quantity,e.innerText=orders[r].totalPrice+" грн",t.innerText=orders[r].quantity,orders.orderSum-=Number(orders[r].product.price.slice(0,-4)),1!==t&&caclnumberOfProducts--,numberOfProductsDOM.innerText=caclnumberOfProducts}orderDetailSum.innerText=orders.orderSum}))}))}inputMask.value="+38",inputMask.addEventListener("input",(function(){let e=inputMask.value;e.length>13?inputMask.value=e.slice(0,13):e.startsWith("+38")||(inputMask.value="+38"+e.slice(3))})),document.addEventListener("DOMContentLoaded",(function(){let e=document.querySelectorAll(".cta-card");console.log(e),e.forEach((function(e){e.addEventListener("click",(function(){alert(1);document.querySelectorAll(".plus-quantity");plusBtn()}))}))}));
