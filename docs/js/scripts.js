document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".burger"),t=document.querySelector(".top-nav");e.addEventListener("click",(function(){this.classList.toggle("active"),t.classList.toggle("activemobile")}));const r=document.querySelector(".mobile-filter"),o=document.querySelector(".filter"),c=document.querySelector(".cancel-filter");document.querySelector(".active-filter");r.addEventListener("click",(function(e){e.preventDefault(),o.classList.add("active-filter")})),c.addEventListener("click",(function(){o.classList.remove("active-filter")}));const n=document.querySelectorAll(".select");n.forEach((e=>{const t=e.querySelector(".select__in"),r=e.querySelectorAll(".select__item"),o=e.querySelector(".select__input"),c=new Event("change");t.addEventListener("click",(()=>{n.forEach((t=>{t!==e&&t.classList.remove("is-opened")})),e.classList.toggle("is-opened")})),r.forEach((n=>{n.addEventListener("click",(()=>{o.value=n.dataset.value,o.dispatchEvent(c),t.innerHTML=n.innerHTML,r.forEach((e=>{e.classList.remove("is-active")})),n.classList.add("is-active"),e.classList.remove("is-opened")}))}))})),document.addEventListener("click",(e=>{e.target.closest(".select")||n.forEach((e=>{e.classList.contains("is-opened")&&e.classList.remove("is-opened")}))})),document.addEventListener("keyup",(e=>{"Escape"==e.key&&n.forEach((e=>{e.classList.contains("is-opened")&&e.classList.remove("is-opened")}))})),orders.orderSumWithNoDiscount=0,orders.orderSumWithDiscount=0,orders.orderSum=0;const s=document.querySelector(".card-bott"),i=document.querySelector(".filter-season"),d=12;let a=1,l=1,u=[];function m(e){const t=(e-1)*d,r=t+d,o=u.slice(t,r);var c;c=o,s.innerHTML="",c.forEach((e=>{console.log(e);const t=document.createElement("figure"),r=document.createElement("figcaption");if(""!==e.saleprice){const t=document.createElement("span"),o=100-100*parseFloat(e.price)/parseFloat(e.saleprice);t.classList.add("card-flag"),t.innerText=`sale -${o.toFixed(0)}%`,r.appendChild(t)}t.classList.add("card-box",e.category,e.color,e.model,e.material,e.style,e.size40,e.size41,e.size42,e.size43,e.size44,e.size45),t.appendChild(r);const o=document.createElement("a");o.classList.add("click-card"),o.href="#",r.appendChild(o);const c=document.createElement("img");c.src=e.img,c.alt=e.alt,r.appendChild(c);const n=document.createElement("h2");n.classList.add("header-card"),n.innerText=e.head,r.appendChild(n);const i=document.createElement("p");i.classList.add("old-price"),i.innerText=e.saleprice,r.appendChild(i);const d=document.createElement("p"),a=parseInt(e.price.replace(/\D/g,""));t.dataset.price=a,d.classList.add("new-price"),d.innerText=e.price,r.appendChild(d);const l=document.createElement("div");l.classList.add("input-block"),r.appendChild(l);const u=["40","41","42","43","44","45"];for(const t of u){const r=document.createElement("input");r.type="checkbox",r.id=`input-${e.id}-${t}`,r.value=t;const o=document.createElement("label");o.classList.add(`label${t}`),o.setAttribute("for",`input-${e.id}-${t}`),o.innerText=`${t}`,r.disabled=!(`size${t}`in e),l.appendChild(r),l.appendChild(o)}const m=document.createElement("a");m.classList.add("cta-card"),m.setAttribute("data-value",e.id),m.innerText=e.cta,m.href=e.href,r.appendChild(m),s.appendChild(t)}))}const p=document.querySelectorAll(".card-cta-season"),f=["winter","summer","demiseason"],v=localStorage.getItem("lastSelectedCategory");function y(e){u.forEach((t=>{const r=document.querySelector(`.${t.category}`);r&&(r.style.display="#all"===e||e===`#${t.category}`?"block":"none")}))}i.addEventListener("click",(e=>{"BUTTON"===e.target.tagName&&(q=e.target.getAttribute("data-href"),localStorage.setItem("lastSelectedCategory",q),k(),y(q),m(a))}));function h(){var e=document.querySelector("#pagination");if(e.innerHTML="",l>1){e.appendChild(S("←","arrow-pag prev",(function(){a>1&&(a--,m(a),h(),g())})));const t=4,r=Math.floor(t/2),o=Math.max(1,a-r),c=Math.min(l,o+t-1);o>1&&(e.appendChild(S(1,"",(function(){a=1,m(a),h(),g()}))),o>2&&e.appendChild(S("...","ellipsis",(function(){}))));for(let t=o;t<=c;t++)!function(t){e.appendChild(S(t,t===a?"active":"",(function(){a=t,m(a),h(),g()})))}(t);c<l&&(c<l-1&&e.appendChild(S("...","ellipsis",(function(){}))),e.appendChild(S(l,"",(function(){a=l,m(a),h(),g()})))),e.appendChild(S("→","arrow-pag next",(function(){a<l&&(a++,m(a),h(),g())})))}}function S(e,t,r){const o=document.createElement("button");return o.innerText=e,o.className=t,o.onclick=r,o}function g(){const e=document.querySelector("#pagination").getElementsByTagName("button");for(var t=0;t<e.length;t++){parseInt(e[t].innerText)===a?(e[t].classList.add("current-page"),e[t].disabled=!0):(e[t].classList.remove("current-page"),e[t].disabled=!1)}}document.querySelector(".select__input").addEventListener("change",(function(){!function(e){const t=document.querySelector(".select__input");switch(parseInt(t.value)){case 2:e.sort(((e,t)=>parseFloat(t.price)-parseFloat(e.price)));break;case 3:e.sort(((e,t)=>parseFloat(e.price)-parseFloat(t.price)))}}(u);m(a),h(),g()})),fetch("products.json").then((e=>e.json())).then((e=>{u=e,l=Math.ceil(u.length/d),m(a),h(),y(q)})).catch((e=>console.error("Помилка завантаження даних:",e)));let q=v;p.forEach((e=>e.style.color="#191919")),v||(q="#all",localStorage.setItem("lastSelectedCategory",q));const b=document.querySelector(`[data-href="${q}"]`);function y(e){f.forEach((t=>{document.querySelectorAll(`.${t}`).forEach((r=>{r.style.display=e===`${t}`||"#all"===e?"block":"none"}))}))}function L(){const e=parseInt(document.querySelector(".input-min").value)||0,t=parseInt(document.querySelector(".input-max").value)||1e4,r=D("size"),o=D("color"),c=D("model"),n=D("season"),s=D("material"),i=D("style");f.forEach((d=>{document.querySelectorAll(`.${d}`).forEach((d=>{const a=E(d.classList,r)&&E(d.classList,o)&&E(d.classList,c)&&E(d.classList,n)&&E(d.classList,s)&&E(d.classList,i)&&function(e,t,r){const o=parseInt(e.dataset.price);return o>=t&&o<=r}(d,e,t);d.style.display=a?"grid":"none"}))}))}function D(e){return Array.from(document.querySelectorAll(`input[name="${e}"]:checked`)).map((e=>e.value))}function E(e,t){return 0===t.length||t.some((t=>e.contains(t)))}function k(){document.querySelectorAll('input[type="checkbox"]').forEach((e=>{e.checked=!1})),document.querySelector(".input-min").value="0",document.querySelector(".input-max").value="10000",document.querySelector(".range-min").value="0",document.querySelector(".range-max").value="10000",document.querySelectorAll(".product-card").forEach((e=>{e.style.display="grid"})),L()}b&&(b.style.color="#fff",b.style.backgroundColor="#4E98B6"),f.forEach((e=>{document.querySelectorAll(`.${e}`).forEach((t=>{t.style.display=q===`${e}`||"#all"===q?"block":"none"}))})),p.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),p.forEach((e=>{e.style.color="#191919",e.style.backgroundColor="#fff"})),e.style.color="#fff",e.style.backgroundColor="#4E98B6";let r=t.target.getAttribute("data-href");localStorage.setItem("lastSelectedCategory",r),y(r)}))})),document.querySelector(".submit-filter").addEventListener("click",(function(e){e.preventDefault(),L()})),document.querySelector('button.cta-transparent.reset-filter[type="reset"]').addEventListener("click",(function(e){e.preventDefault(),k()}));const x=document.querySelectorAll(".slider-images img"),C=document.querySelector(".arr-left"),N=document.querySelector(".arr-right"),T=document.querySelectorAll(".slide-description");let W=0;function P(){T[W].classList.remove("active"),x[W].classList.remove("active"),W=(W+1)%x.length,x[W].classList.add("active"),T[W].classList.add("active")}P();let O=setInterval(P,3e3);C.addEventListener("click",(function(){clearInterval(O),T[W].classList.remove("active"),x[W].classList.remove("active"),W=(W-1+x.length)%x.length,x[W].classList.add("active"),T[W].classList.add("active"),O=setInterval(P,3e3)})),N.addEventListener("click",(function(){clearInterval(O),P(),O=setInterval(P,3e3)}));const $=document.querySelector(".cart"),A=document.querySelector(".popup"),M=document.querySelector(".basket-back"),I=document.querySelector("body");function z(){A.classList.toggle("d-block"),I.classList.toggle("hidden")}$.addEventListener("click",z),M.addEventListener("click",z);const B=document.querySelectorAll(".range-input input"),j=document.querySelectorAll(".price-input input"),w=document.querySelector(".slider .progress");let _=1e3;j.forEach((e=>{e.addEventListener("input",(e=>{let t=parseInt(j[0].value),r=parseInt(j[1].value);r-t>=_&&r<=B[1].max&&("input-min"===e.target.className?(B[0].value=t,w.style.left=t/B[0].max*100+"%"):(B[1].value=r,w.style.right=100-r/B[1].max*100+"%"))}))})),B.forEach((e=>{e.addEventListener("input",(e=>{let t=parseInt(B[0].value),r=parseInt(B[1].value);r-t<_?"range-min"===e.target.className?B[0].value=r-_:B[1].value=t+_:(j[0].value=t,j[1].value=r,w.style.left=t/B[0].max*100+"%",w.style.right=100-r/B[1].max*100+"%")}))}));let F=document.querySelector(".img-carousel"),H=document.querySelectorAll(".step-block");const J=document.querySelectorAll(".img-carousel img");console.log(F),function(){let e=0;H.forEach((function(t){e+=t.getBoundingClientRect().height,console.log(e)})),window,innerHeight>=960&&(F.style.height=e+40+"px")}();let R=0;setInterval((function(){J[R].classList.remove("active"),R=(R+1)%J.length,J[R].classList.add("active")}),3e3)}));let orderDetailSum=document.querySelector(".order-total-price"),orderWithDiscountPrice=document.querySelector(".price-totally b"),orderWithDiscountPriceCalc=0,numberOfProductsDOM=document.querySelector(".calc-added-products"),caclnumberOfProducts=0,addedProductsList=document.querySelector(".added-products-list "),orderDiscount=document.querySelector(".order-discount"),orderDiscountCalc=0;orders={};const cartWaitTimeout=setTimeout((function(){cart()}),1e3);function cart(){if(document.querySelectorAll(".cta-card")){clearInterval(cartWaitTimeout);document.querySelectorAll(".cta-card");document.querySelectorAll(".cta-card").forEach((t=>{t.addEventListener("click",(function(r){r.preventDefault();const o=this.getAttribute("data-value"),c=[];document.querySelectorAll(`input[type="checkbox"][id^="input-${o}"]:checked`).forEach((e=>{c.push(e.value)})),console.log("Вибрані розміри для продукту з ID",o,":",c),function(t,r){let o=t.dataset.value;fetch("products.json").then((e=>e.json())).then((t=>{const c=t.find((e=>e.id===o));if(""===c.saleprice&&(c.saleprice=c.price),r.length>1){console.log(r);for(let t=0;t<r.length;t++)orders[o+r[t]]?document.querySelector(".plus-quantity[data-value='"+o+r[t]+"']").click():(orders[o+r[t]]={product:c,quantity:1},r&&(orders[o+r[t]].size=r[t]),orders.orderSumWithNoDiscount+=""!=orders[o+r[t]].product.saleprice?Number(orders[o+r[t]].product.saleprice.slice(0,-4)):0,orders.orderSumWithDiscount+=Number(orders[o+r[t]].product.price.slice(0,-4)),e(o,orders[o+r[t]].size),console.log(document.querySelector(".minus-quantity[data-value='"+o+r[t]+"']")),plusBtn(".plus-quantity[data-value='"+o+r[t]+"']"),minBtn(".minus-quantity[data-value='"+o+r[t]+"']"),caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts,orderDiscountCalc+=Number(orders[o+r[t]].product.saleprice.slice(0,-4))-Number(orders[o+r[t]].product.price.slice(0,-4)),console.log(1),console.log(orderDiscountCalc),orderDiscount.innerText=orderDiscountCalc,orderDetailSum.innerText=0!=orders.orderSumWithNoDiscount?orders.orderSumWithNoDiscount:orders.orderSumWithDiscount,orderWithDiscountPrice.innerText=orders.orderSumWithDiscount);console.log(orders)}else orders[o+r]?(caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts,orders[o+r].size[0]!=r?(e(o,r),setTimeout((()=>{console.log(document.querySelector(".minus-quantity[data-value='"+o+r+"']")),plusBtn('.basket-card[data-value="'+o+r+'"] .plus-quantity'),minBtn(".minus-quantity[data-value='"+o+r+"']")}),100)):orders[o+r].quantity++,orders.orderSumWithNoDiscount+=""!=orders[o+r].product.saleprice?Number(orders[o+r].product.saleprice.slice(0,-4)):0,orders.orderSumWithDiscount+=Number(orders[o+r].product.price.slice(0,-4)),setTimeout((function(){const e=addedProductsList.querySelector('.basket-card[data-value="'+o+r+'"] .total-price span'),t=addedProductsList.querySelector('.basket-card[data-value="'+o+r+'"] .quantity-number');orders[o+r].totalPrice=Number(orders[o+r].product.price.slice(0,-4))*orders[o+r].quantity,e.innerText=orders[o+r].totalPrice+" грн",t.innerText=orders[o+r].quantity}),10),orderDiscountCalc+=Number(orders[o+r].product.saleprice.slice(0,-4))-Number(orders[o+r].product.price.slice(0,-4)),console.log(2),console.log(orderDiscountCalc),orderDiscount.innerText=orderDiscountCalc):(orders[o+r]={product:c,quantity:0},orders[o+r].quantity+=1,r&&(orders[o+r].size=r),orders.orderSumWithNoDiscount+=""!=orders[o+r].product.saleprice?Number(orders[o+r].product.saleprice.slice(0,-4)):0,orders.orderSumWithDiscount+=Number(orders[o+r].product.price.slice(0,-4)),e(o,orders[o+r].size),console.log(document.querySelector(".minus-quantity[data-value='"+o+r+"']")),plusBtn(".plus-quantity[data-value='"+o+r+"']"),minBtn(".minus-quantity[data-value='"+o+r+"']"),caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts,orderDiscountCalc+=Number(orders[o+r].product.saleprice.slice(0,-4))-Number(orders[o+r].product.price.slice(0,-4)),console.log(3),console.log(orderDiscountCalc),orderDiscount.innerText=orderDiscountCalc),orderDetailSum.innerText=0!=orders.orderSumWithNoDiscount?orders.orderSumWithNoDiscount:orders.orderSumWithDiscount,orderWithDiscountPrice.innerText=orders.orderSumWithDiscount}))}(t,c)}))}))}function e(e,t){fetch("products.json").then((e=>e.json())).then((r=>{const o=r.find((t=>t.id===e)),c=document.createElement("div");c.innerHTML=`\n                    <div class="basket-card flex-between" data-value=${o.id+""+t}>\n                        <img src=${o.img}>\n                        \n                        <div class="w-100 flex-between items-center">\n                            <div class="description">\n                                <div>\n                                    <h3>${o.head}</h3>\n                                    <table>\n                                        <tr>\n                                            <td>колір</td>\n                                            <td>${o.color}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>розмір</td>\n                                            <td class="size-span">${t}</td>\n                                        </tr>\n                                        <tr>\n                                            <td>ціна</td>\n                                            <td>${o.price} <span>${o.saleprice}</span></td>\n                                        </tr>\n                                        <tr>\n                                            <td>кількість</td>\n                                            <td>\n                                                <div class="quantity flex">\n                                                    <div class="minus-quantity" data-value="${o.id+""+t}">-</div>\n                                                    <div class="quantity-number">${orders[o.id+t].quantity}</div>\n                                                    <div class="plus-quantity" data-value="${o.id+""+t}">+</div>\n                                                </div>\n                                            </td>\n                                        </tr>\n                                    </table>\n                                    <div class="delete-product">видалити товар</div>\n                                </div>\n                            </div>\n                            <div class="total-price">\n                                <span>${Number(orders[o.id+t].product.price.slice(0,-4))*orders[o.id+t].quantity+" грн"}</span>\n                            </div>\n                        </div>\n                    </div>\n                `,addedProductsList.appendChild(c)}))}}const inputMask=document.querySelector(".inputMask");function plusBtn(e){fetch("products.json").then((e=>e.json())).then((t=>{document.querySelector(e).addEventListener("click",(function(){let e=this.dataset.value;console.log(e);let r=this.dataset.value.slice(0,-2);t.find((e=>e.id===r));const o=e;if(orders[o]){orders[o].quantity+=1;const t=addedProductsList.querySelector('[data-value="'+e+'"] .total-price span'),r=addedProductsList.querySelector('[data-value="'+e+'"] .quantity-number');t.innerText=orders[o].product.price.slice(0,-4)*orders[o].quantity+" грн",r.innerText=orders[o].quantity,orders.orderSumWithNoDiscount+=0!==orders[o].product.saleprice?Number(orders[o].product.saleprice.slice(0,-4)):0,orders.orderSumWithDiscount+=Number(orders[o].product.price.slice(0,-4))}orderDetailSum.innerText=0!=orders.orderSumWithNoDiscount?orders.orderSumWithNoDiscount:orders.orderSumWithDiscount,orderWithDiscountPrice.innerText=orders.orderSumWithDiscount,caclnumberOfProducts++,numberOfProductsDOM.innerText=caclnumberOfProducts,orderDiscountCalc+=Number(orders[r+e.slice(-2)].product.saleprice.slice(0,-4))-Number(orders[r+e.slice(-2)].product.price.slice(0,-4)),console.log(4),console.log(orderDiscountCalc),orderDiscount.innerText=orderDiscountCalc}))}))}function minBtn(e){fetch("products.json").then((e=>e.json())).then((t=>{document.querySelector(e).addEventListener("click",(function(){let e=this.dataset.value,r=e.slice(0,-2);t.find((e=>e.id===r));const o=e;if(console.log(r),console.log(o),orders[o]&&1!==orders[o].quantity){orders[o].quantity-=1;const t=addedProductsList.querySelector('[data-value="'+o+'"] .total-price span'),c=addedProductsList.querySelector('[data-value="'+o+'"] .quantity-number');orders[o].totalPrice=Number(orders[o].product.price.slice(0,-4))*orders[o].quantity,t.innerText=orders[o].totalPrice+" грн",c.innerText=orders[o].quantity,orders.orderSumWithNoDiscount-=""!=orders[o].product.saleprice?Number(orders[o].product.saleprice.slice(0,-4)):0,orders.orderSumWithDiscount-=Number(orders[o].product.price.slice(0,-4)),1!==c&&caclnumberOfProducts--,numberOfProductsDOM.innerText=caclnumberOfProducts,orderDetailSum.innerText=0!=orders.orderSumWithNoDiscount?orders.orderSumWithNoDiscount:orders.orderSumWithDiscount,orderWithDiscountPrice.innerText=orders.orderSumWithDiscount,orderDiscountCalc-=Number(orders[r+e.slice(-2)].product.saleprice.slice(0,-4))-Number(orders[r+e.slice(-2)].product.price.slice(0,-4)),console.log(5),console.log(orderDiscountCalc),orderDiscount.innerText=orderDiscountCalc}}))}))}function sendData(){let e=document.querySelector("#orderProductsObject");const t=JSON.stringify(orders);e.value=t}inputMask.value="+38",inputMask.addEventListener("input",(function(){let e=inputMask.value;e.length>13?inputMask.value=e.slice(0,13):e.startsWith("+38")||(inputMask.value="+38"+e.slice(3))})),document.addEventListener("DOMContentLoaded",(function(){let e=document.querySelectorAll(".cta-card");console.log(e),e.forEach((function(e){e.addEventListener("click",(function(){document.querySelectorAll(".plus-quantity");plusBtn()}))}))})),document.addEventListener("DOMContentLoaded",(function(){document.addEventListener("click",(function(e){if(e.target.classList.contains("delete-product")){const t=e.target.closest(".basket-card"),r=t.dataset.value;if(orders[r]){orders[r].size;caclnumberOfProducts-=orders[r].quantity,numberOfProductsDOM.innerText=caclnumberOfProducts,orders.orderSumWithNoDiscount-=Number(orders[r].product.saleprice.slice(0,-4))*orders[r].quantity,orderDetailSum.innerText=orders.orderSumWithNoDiscount,orderDiscountCalc-=(Number(orders[r].product.saleprice.slice(0,-4))-Number(orders[r].product.price.slice(0,-4)))*orders[r].quantity,orderDiscount.innerText=orderDiscountCalc,orders.orderSumWithDiscount-=Number(orders[r].product.price.slice(0,-4))*orders[r].quantity,orderWithDiscountPrice.innerText=orders.orderSumWithDiscount,delete orders[r],t.remove()}}}))})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector("#openConfirmPopup"),t=document.querySelector(".order-confirm-popup"),r=document.querySelector(".confirm-back");e.addEventListener("click",(function(){sendData(),t.classList.toggle("d-block")})),r.addEventListener("click",(function(){t.classList.toggle("d-block")}))}));
